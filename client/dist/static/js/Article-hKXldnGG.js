import{NTabPane as F,NCard as q,NSpace as M,NButton as U,NForm as T,NFormItem as C,NInput as D,NSelect as A,NTabs as G}from"naive-ui";/* empty css                    */import{i as O,s as K,r as w,w as H,q as _,B as b,y as l,u as o,a as E,A as Y,x as n,F as L,D as R,C as I,G as V,E as p,H as h}from"./@vue-BTzi4prS.js";const J={style:{border:"1px solid #ccc","margin-top":"10px"}},P={__name:"RichTextEditor",props:{modelValue:{type:String,default:""},clearCommand:{type:Boolean,default:!1}},emits:["update:model-value"],setup(z,{emit:c}){const{Toolbar:i,Editor:v}=window.wangeditor,m=O("server_url"),g=K(),d=w(),x=w("default"),f={excludeKeys:["uploadVideo"]},y={placeholder:"请输入内容..."};y.MENU_CONF={},y.MENU_CONF.uploadImage={base64LimitSize:10*1024,server:m+"/upload/rich_editor_upload"},y.MENU_CONF.insertImage={parseImageSrc:s=>s.indexOf("Http")!==0?`${m}${s}`:s};const r=z,u=c,$=s=>{console.log("created",s),g.value=s},S=s=>{u("update:model-value",d.value)};return H(()=>r.modelValue,s=>{s!==d.value&&(d.value=s)},{immediate:!0}),H(()=>r.clearCommand,s=>{s&&(d.value="",console.log("clear"))},{immediate:!0}),(s,k)=>(_(),b("div",J,[l(o(i),{editor:g.value,defaultConfig:f,mode:x.value,style:{"border-bottom":"1px solid #ccc"}},null,8,["editor","mode"]),l(o(v),{defaultConfig:y,mode:x.value,modelValue:d.value,"onUpdate:modelValue":k[0]||(k[0]=B=>d.value=B),style:{height:"400px","overflow-y":"hidden"},onOnCreated:$,onOnChange:S},null,8,["mode","modelValue"])]))}},Q=["onClick"],ee={__name:"Article",setup(z){const c=O("axios"),i=O("message"),v=w([]),m=w(!1),g=w("list"),d=E({page:1,pageSize:3,pageCount:0,count:0});let x=w([]);Y(()=>{y(),f()});const f=async()=>{let a=await c.get(`/blog/search?page=${d.page}&pageSize=${d.pageSize}`),e=a.data.rows;for(let t of e){t.content+="...";let N=new Date(t.create_time);t.create_time=`${N.getFullYear()}/${N.getMonth()+1}/${N.getDate()}`}x.value=e,console.log(a),d.count=a.data.count,d.pageCount=Math.ceil(d.count/d.pageSize),console.log(d)},y=async()=>{let a=await c.get("/category/list");v.value=a.data.rows.map(e=>({label:e.name,value:e.id})),console.log(v.value)},r=E({content:"hello",title:"",categoryid:""}),u=E({id:"",title:"",categoryid:"",content:""}),$=async()=>{try{let a=await c.post("/blog/_token/add",{title:r.title,categoryId:r.categoryid,content:r.content});console.log(a),a.data.code==200?(i.success(a.data.msg),r.title="",r.categoryid="",m.value=!0,console.log("command"),setTimeout(()=>m.value=!1,0)):i.error(a.data.msg)}catch(a){i.error(a.response.data.msg)}},S=async a=>{d.page=a,f()},s=async a=>{g.value="update";let e=await c.get("/blog/detail?id="+a.id);console.log(e),u.id=a.id,u.title=e.data.rows[0].title,u.content=e.data.rows[0].content,u.categoryid=e.data.rows[0].category_id},k=async a=>{try{let e=await c.delete("/blog/_token/delete?id="+a.id);e.data.code==200?(i.success(e.data.msg),f()):i.error(e.data.msg)}catch(e){i.error(e.response.data.msg)}},B=async()=>{try{let a=await c.post("/blog/_token/update",u);console.log(a),a.data.code==200?(i.success(a.data.msg),g.value="list",f()):i.error(a.data.msg)}catch(a){i.error(a.response.data.msg)}};return(a,e)=>(_(),b("div",null,[l(o(G),{value:g.value,"onUpdate:value":e[7]||(e[7]=t=>g.value=t),type:"line",animated:""},{default:n(()=>[l(o(F),{name:"list",tab:"文章列表"},{default:n(()=>[(_(!0),b(L,null,R(o(x),(t,N)=>(_(),b("div",null,[l(o(q),{title:t.title},{footer:n(()=>[l(o(M),{align:"center"},{default:n(()=>[I("div",null,V(t.create_time),1),l(o(U),{onClick:j=>s(t)},{default:n(()=>e[8]||(e[8]=[p("修改")])),_:2},1032,["onClick"]),l(o(U),{onClick:j=>k(t)},{default:n(()=>e[9]||(e[9]=[p("删除")])),_:2},1032,["onClick"])]),_:2},1024)]),default:n(()=>[p(V(t.content)+" ",1)]),_:2},1032,["title"])]))),256)),l(o(M),null,{default:n(()=>[(_(!0),b(L,null,R(d.pageCount,t=>(_(),b("div",{onClick:N=>S(t),style:h({color:t===d.page?"green":"black"})},V(t),13,Q))),256))]),_:1})]),_:1}),l(o(F),{name:"add",tab:"添加文章"},{default:n(()=>[l(o(T),null,{default:n(()=>[l(o(C),{label:"标题"},{default:n(()=>[l(o(D),{value:r.title,"onUpdate:value":e[0]||(e[0]=t=>r.title=t),placeholder:"输入标题"},null,8,["value"])]),_:1}),l(o(C),{label:"分类"},{default:n(()=>[l(o(A),{value:r.categoryid,"onUpdate:value":e[1]||(e[1]=t=>r.categoryid=t),options:v.value},null,8,["value","options"])]),_:1}),l(o(C),{label:"内容"},{default:n(()=>[l(P,{modelValue:r.content,"onUpdate:modelValue":e[2]||(e[2]=t=>r.content=t),clearCommand:m.value},null,8,["modelValue","clearCommand"])]),_:1}),p(" "+V(r.content),1)]),_:1}),I("div",null,[l(o(U),{onClick:e[3]||(e[3]=t=>$())},{default:n(()=>e[10]||(e[10]=[p("添加")])),_:1})])]),_:1}),l(o(F),{name:"update",tab:"修改文章"},{default:n(()=>[l(o(T),null,{default:n(()=>[l(o(C),{label:"标题"},{default:n(()=>[l(o(D),{value:u.title,"onUpdate:value":e[4]||(e[4]=t=>u.title=t),placeholder:"输入标题"},null,8,["value"])]),_:1}),l(o(C),{label:"分类"},{default:n(()=>[l(o(A),{value:u.categoryid,"onUpdate:value":e[5]||(e[5]=t=>u.categoryid=t),options:v.value},null,8,["value","options"])]),_:1}),l(o(C),{label:"内容"},{default:n(()=>[l(P,{modelValue:u.content,"onUpdate:modelValue":e[6]||(e[6]=t=>u.content=t),clearCommand:m.value},null,8,["modelValue","clearCommand"])]),_:1}),p(" "+V(u.content),1)]),_:1}),I("div",null,[l(o(U),{onClick:B},{default:n(()=>e[11]||(e[11]=[p("修改")])),_:1})])]),_:1})]),_:1},8,["value"])]))}};export{ee as default};
