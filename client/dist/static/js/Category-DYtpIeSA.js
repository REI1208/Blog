import{NButton as u,NSpace as A,NTable as E,NInput as N,NModal as c}from"naive-ui";import{r as y,o as F,f as U,a as w,c as k,B as n,A as s,u as o,i as C,G as g,D as l,F as L,E as S,H as D,n as j}from"./@vue-B4preGn0.js";const q={__name:"Category",setup(G){const m=C("axios"),d=C("message"),$=C("dialog"),x=y([]),i=y(!1),v=y(!1);F(()=>{p()});const p=async()=>{let t=await m.get("/category/list");x.value=t.data.rows},f=U({name:""}),r=U({name:"",id:""}),B=async()=>{try{let t=await m.post("/category/_token/add",{name:f.name});console.log(t),t.data.code==200?(p(),d.success(t.data.msg)):d.error(t.data.msg)}catch(t){d.error(t.response.data.msg)}i.value=!1},T=async t=>{try{$.warning({title:"警告",content:"确认删除？",positiveText:"确定",negativeText:"不确定",onPositiveClick:async()=>{let e=await m.delete(`/category/_token/delete?id=${t.id}`);e.data.code==200?(p(),d.success(e.data.msg)):d.error(e.data.msg)},onNegativeClick:()=>{}})}catch(e){d.error(e.response.data.msg),console.log("其他错误:",e.message)}i.value=!1},M=async t=>{v.value=!0,r.id=t.id,r.name=t.name},b=async()=>{try{let t=await m.put("/category/_token/update",{id:r.id,name:r.name});t.data.code==200?(await j(),d.success(t.data.msg)):d.error(t.data.msg)}catch(t){d.error(t.response.data.msg),console.log("其他错误:",t.message)}v.value=!1};return(t,e)=>(w(),k("div",null,[n(o(u),{onClick:e[0]||(e[0]=a=>i.value=!0)},{default:s(()=>e[7]||(e[7]=[g("添加")])),_:1}),n(o(E),{bordered:!1,"single-line":!1},{default:s(()=>[e[10]||(e[10]=l("thead",null,[l("tr",null,[l("th",null,"编号"),l("th",null,"名称"),l("th",null,"操作")])],-1)),l("tbody",null,[(w(!0),k(L,null,S(x.value,(a,H)=>(w(),k("tr",null,[l("td",null,D(a.id),1),l("td",null,D(a.name),1),l("td",null,[n(o(A),null,{default:s(()=>[n(o(u),{onClick:V=>M(a)},{default:s(()=>e[8]||(e[8]=[g(" 修改 ")])),_:2},1032,["onClick"]),n(o(u),{onClick:V=>T(a)},{default:s(()=>e[9]||(e[9]=[g("删除")])),_:2},1032,["onClick"])]),_:2},1024)])]))),256))])]),_:1}),n(o(c),{show:i.value,"onUpdate:show":e[3]||(e[3]=a=>i.value=a),preset:"dialog",title:"Dialog"},{header:s(()=>e[11]||(e[11]=[l("div",null,"添加分类",-1)])),action:s(()=>[l("div",null,[n(o(u),{onClick:e[2]||(e[2]=a=>B())},{default:s(()=>e[12]||(e[12]=[g("添加")])),_:1})])]),default:s(()=>[l("div",null,[n(o(N),{value:f.name,"onUpdate:value":e[1]||(e[1]=a=>f.name=a),type:"text",placeholder:"输入分类"},null,8,["value"])])]),_:1},8,["show"]),n(o(c),{show:v.value,"onUpdate:show":e[6]||(e[6]=a=>v.value=a),preset:"dialog",title:"Dialog"},{header:s(()=>e[13]||(e[13]=[l("div",null,"修改分类",-1)])),action:s(()=>[l("div",null,[n(o(u),{onClick:e[5]||(e[5]=a=>b(t.category))},{default:s(()=>e[14]||(e[14]=[g("修改")])),_:1})])]),default:s(()=>[l("div",null,[n(o(N),{value:r.name,"onUpdate:value":e[4]||(e[4]=a=>r.name=a),type:"text",placeholder:"输入分类"},null,8,["value"])])]),_:1},8,["show"])]))}};export{q as default};
