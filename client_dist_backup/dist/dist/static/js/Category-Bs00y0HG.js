const w={__name:"Category",setup(f){const o=Vue.inject("axios"),a=Vue.inject("message"),s=Vue.inject("dialog"),i=Vue.ref([]),l=Vue.ref(!1),r=Vue.ref(!1);Vue.onMounted(()=>{d()});const d=async()=>{let t=await o.get("/category/list");i.value=t.data.rows},V=Vue.reactive({name:""}),n=Vue.reactive({name:"",id:""}),m=async()=>{try{let t=await o.post("/category/_token/add",{name:V.name});console.log(t),t.data.code==200?(d(),a.success(t.data.msg)):a.error(t.data.msg)}catch(t){a.error(t.response.data.msg)}l.value=!1},v=async t=>{try{s.warning({title:"警告",content:"确认删除？",positiveText:"确定",negativeText:"不确定",onPositiveClick:async()=>{let e=await o.delete(`/category/_token/delete?id=${t.id}`);e.data.code==200?(d(),a.success(e.data.msg)):a.error(e.data.msg)},onNegativeClick:()=>{}})}catch(e){a.error(e.response.data.msg),console.log("其他错误:",e.message)}l.value=!1},c=async t=>{r.value=!0,n.id=t.id,n.name=t.name},N=async()=>{try{let t=await o.put("/category/_token/update",{id:n.id,name:n.name});t.data.code==200?(await Vue.nextTick(),a.success(t.data.msg)):a.error(t.data.msg)}catch(t){a.error(t.response.data.msg),console.log("其他错误:",t.message)}r.value=!1};return(t,e)=>(Vue.openBlock(),Vue.createElementBlock("div",null,[Vue.createVNode(Vue.unref(naive-ui.NButton),{onClick:e[0]||(e[0]=u=>l.value=!0)},{default:Vue.withCtx(()=>e[7]||(e[7]=[Vue.createTextVNode("添加")])),_:1}),Vue.createVNode(Vue.unref(naive-ui.NTable),{bordered:!1,"single-line":!1},{default:Vue.withCtx(()=>[e[10]||(e[10]=Vue.createElementVNode("thead",null,[Vue.createElementVNode("tr",null,[Vue.createElementVNode("th",null,"编号"),Vue.createElementVNode("th",null,"名称"),Vue.createElementVNode("th",null,"操作")])],-1)),Vue.createElementVNode("tbody",null,[(Vue.openBlock(!0),Vue.createElementBlock(Vue.Fragment,null,Vue.renderList(i.value,(u,p)=>(Vue.openBlock(),Vue.createElementBlock("tr",null,[Vue.createElementVNode("td",null,Vue.toDisplayString(u.id),1),Vue.createElementVNode("td",null,Vue.toDisplayString(u.name),1),Vue.createElementVNode("td",null,[Vue.createVNode(Vue.unref(naive-ui.NSpace),null,{default:Vue.withCtx(()=>[Vue.createVNode(Vue.unref(naive-ui.NButton),{onClick:g=>c(u)},{default:Vue.withCtx(()=>e[8]||(e[8]=[Vue.createTextVNode(" 修改 ")])),_:2},1032,["onClick"]),Vue.createVNode(Vue.unref(naive-ui.NButton),{onClick:g=>v(u)},{default:Vue.withCtx(()=>e[9]||(e[9]=[Vue.createTextVNode("删除")])),_:2},1032,["onClick"])]),_:2},1024)])]))),256))])]),_:1}),Vue.createVNode(Vue.unref(naive-ui.NModal),{show:l.value,"onUpdate:show":e[3]||(e[3]=u=>l.value=u),preset:"dialog",title:"Dialog"},{header:Vue.withCtx(()=>e[11]||(e[11]=[Vue.createElementVNode("div",null,"添加分类",-1)])),action:Vue.withCtx(()=>[Vue.createElementVNode("div",null,[Vue.createVNode(Vue.unref(naive-ui.NButton),{onClick:e[2]||(e[2]=u=>m())},{default:Vue.withCtx(()=>e[12]||(e[12]=[Vue.createTextVNode("添加")])),_:1})])]),default:Vue.withCtx(()=>[Vue.createElementVNode("div",null,[Vue.createVNode(Vue.unref(naive-ui.NInput),{value:V.name,"onUpdate:value":e[1]||(e[1]=u=>V.name=u),type:"text",placeholder:"输入分类"},null,8,["value"])])]),_:1},8,["show"]),Vue.createVNode(Vue.unref(naive-ui.NModal),{show:r.value,"onUpdate:show":e[6]||(e[6]=u=>r.value=u),preset:"dialog",title:"Dialog"},{header:Vue.withCtx(()=>e[13]||(e[13]=[Vue.createElementVNode("div",null,"修改分类",-1)])),action:Vue.withCtx(()=>[Vue.createElementVNode("div",null,[Vue.createVNode(Vue.unref(naive-ui.NButton),{onClick:e[5]||(e[5]=u=>N(t.category))},{default:Vue.withCtx(()=>e[14]||(e[14]=[Vue.createTextVNode("修改")])),_:1})])]),default:Vue.withCtx(()=>[Vue.createElementVNode("div",null,[Vue.createVNode(Vue.unref(naive-ui.NInput),{value:n.name,"onUpdate:value":e[4]||(e[4]=u=>n.name=u),type:"text",placeholder:"输入分类"},null,8,["value"])])]),_:1},8,["show"])]))}};export{w as default};
