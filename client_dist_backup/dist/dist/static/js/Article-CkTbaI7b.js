/* empty css                    */const _={style:{border:"1px solid #ccc","margin-top":"10px"}},x={__name:"RichTextEditor",props:{modelValue:{type:String,default:""},clearCommand:{type:Boolean,default:!1}},emits:["update:model-value"],setup(w,{emit:i}){const{Toolbar:r,Editor:c}=window.wangeditor,d=Vue.inject("server_url"),V=Vue.shallowRef(),u=Vue.ref(),v=Vue.ref("default"),s={excludeKeys:["uploadVideo"]},m={placeholder:"请输入内容..."};m.MENU_CONF={},m.MENU_CONF.uploadImage={base64LimitSize:10*1024,server:d+"/upload/rich_editor_upload"},m.MENU_CONF.insertImage={parseImageSrc:l=>l.indexOf("Http")!==0?`${d}${l}`:l};const o=w,n=i,g=l=>{console.log("created",l),V.value=l},N=l=>{n("update:model-value",u.value)};return Vue.watch(()=>o.modelValue,l=>{l!==u.value&&(u.value=l)},{immediate:!0}),Vue.watch(()=>o.clearCommand,l=>{l&&(u.value="",console.log("clear"))},{immediate:!0}),(l,f)=>(Vue.openBlock(),Vue.createElementBlock("div",_,[Vue.createVNode(Vue.unref(r),{editor:V.value,defaultConfig:s,mode:v.value,style:{"border-bottom":"1px solid #ccc"}},null,8,["editor","mode"]),Vue.createVNode(Vue.unref(c),{defaultConfig:m,mode:v.value,modelValue:u.value,"onUpdate:modelValue":f[0]||(f[0]=C=>u.value=C),style:{height:"400px","overflow-y":"hidden"},onOnCreated:g,onOnChange:N},null,8,["mode","modelValue"])]))}},k=["onClick"],h={__name:"Article",setup(w){const i=Vue.inject("axios"),r=Vue.inject("message"),c=Vue.ref([]),d=Vue.ref(!1),V=Vue.ref("list"),u=Vue.reactive({page:1,pageSize:3,pageCount:0,count:0});let v=Vue.ref([]);Vue.onMounted(()=>{m(),s()});const s=async()=>{let a=await i.get(`/blog/search?page=${u.page}&pageSize=${u.pageSize}`),e=a.data.rows;for(let t of e){t.content+="...";let p=new Date(t.create_time);t.create_time=`${p.getFullYear()}/${p.getMonth()+1}/${p.getDate()}`}v.value=e,console.log(a),u.count=a.data.count,u.pageCount=Math.ceil(u.count/u.pageSize),console.log(u)},m=async()=>{let a=await i.get("/category/list");c.value=a.data.rows.map(e=>({label:e.name,value:e.id})),console.log(c.value)},o=Vue.reactive({content:"hello",title:"",categoryid:""}),n=Vue.reactive({id:"",title:"",categoryid:"",content:""}),g=async()=>{try{let a=await i.post("/blog/_token/add",{title:o.title,categoryId:o.categoryid,content:o.content});console.log(a),a.data.code==200?(r.success(a.data.msg),o.title="",o.categoryid="",d.value=!0,console.log("command"),setTimeout(()=>d.value=!1,0)):r.error(a.data.msg)}catch(a){r.error(a.response.data.msg)}},N=async a=>{u.page=a,s()},l=async a=>{V.value="update";let e=await i.get("/blog/detail?id="+a.id);console.log(e),n.id=a.id,n.title=e.data.rows[0].title,n.content=e.data.rows[0].content,n.categoryid=e.data.rows[0].category_id},f=async a=>{try{let e=await i.delete("/blog/_token/delete?id="+a.id);e.data.code==200?(r.success(e.data.msg),s()):r.error(e.data.msg)}catch(e){r.error(e.response.data.msg)}},C=async()=>{try{let a=await i.post("/blog/_token/update",n);console.log(a),a.data.code==200?(r.success(a.data.msg),V.value="list",s()):r.error(a.data.msg)}catch(a){r.error(a.response.data.msg)}};return(a,e)=>(Vue.openBlock(),Vue.createElementBlock("div",null,[Vue.createVNode(Vue.unref(naive-ui.NTabs),{value:V.value,"onUpdate:value":e[7]||(e[7]=t=>V.value=t),type:"line",animated:""},{default:Vue.withCtx(()=>[Vue.createVNode(Vue.unref(naive-ui.NTabPane),{name:"list",tab:"文章列表"},{default:Vue.withCtx(()=>[(Vue.openBlock(!0),Vue.createElementBlock(Vue.Fragment,null,Vue.renderList(Vue.unref(v),(t,p)=>(Vue.openBlock(),Vue.createElementBlock("div",null,[Vue.createVNode(Vue.unref(naive-ui.NCard),{title:t.title},{footer:Vue.withCtx(()=>[Vue.createVNode(Vue.unref(naive-ui.NSpace),{align:"center"},{default:Vue.withCtx(()=>[Vue.createElementVNode("div",null,Vue.toDisplayString(t.create_time),1),Vue.createVNode(Vue.unref(naive-ui.NButton),{onClick:y=>l(t)},{default:Vue.withCtx(()=>e[8]||(e[8]=[Vue.createTextVNode("修改")])),_:2},1032,["onClick"]),Vue.createVNode(Vue.unref(naive-ui.NButton),{onClick:y=>f(t)},{default:Vue.withCtx(()=>e[9]||(e[9]=[Vue.createTextVNode("删除")])),_:2},1032,["onClick"])]),_:2},1024)]),default:Vue.withCtx(()=>[Vue.createTextVNode(Vue.toDisplayString(t.content)+" ",1)]),_:2},1032,["title"])]))),256)),Vue.createVNode(Vue.unref(naive-ui.NSpace),null,{default:Vue.withCtx(()=>[(Vue.openBlock(!0),Vue.createElementBlock(Vue.Fragment,null,Vue.renderList(u.pageCount,t=>(Vue.openBlock(),Vue.createElementBlock("div",{onClick:p=>N(t),style:Vue.normalizeStyle({color:t===u.page?"green":"black"})},Vue.toDisplayString(t),13,k))),256))]),_:1})]),_:1}),Vue.createVNode(Vue.unref(naive-ui.NTabPane),{name:"add",tab:"添加文章"},{default:Vue.withCtx(()=>[Vue.createVNode(Vue.unref(naive-ui.NForm),null,{default:Vue.withCtx(()=>[Vue.createVNode(Vue.unref(naive-ui.NFormItem),{label:"标题"},{default:Vue.withCtx(()=>[Vue.createVNode(Vue.unref(naive-ui.NInput),{value:o.title,"onUpdate:value":e[0]||(e[0]=t=>o.title=t),placeholder:"输入标题"},null,8,["value"])]),_:1}),Vue.createVNode(Vue.unref(naive-ui.NFormItem),{label:"分类"},{default:Vue.withCtx(()=>[Vue.createVNode(Vue.unref(naive-ui.NSelect),{value:o.categoryid,"onUpdate:value":e[1]||(e[1]=t=>o.categoryid=t),options:c.value},null,8,["value","options"])]),_:1}),Vue.createVNode(Vue.unref(naive-ui.NFormItem),{label:"内容"},{default:Vue.withCtx(()=>[Vue.createVNode(x,{modelValue:o.content,"onUpdate:modelValue":e[2]||(e[2]=t=>o.content=t),clearCommand:d.value},null,8,["modelValue","clearCommand"])]),_:1}),Vue.createTextVNode(" "+Vue.toDisplayString(o.content),1)]),_:1}),Vue.createElementVNode("div",null,[Vue.createVNode(Vue.unref(naive-ui.NButton),{onClick:e[3]||(e[3]=t=>g())},{default:Vue.withCtx(()=>e[10]||(e[10]=[Vue.createTextVNode("添加")])),_:1})])]),_:1}),Vue.createVNode(Vue.unref(naive-ui.NTabPane),{name:"update",tab:"修改文章"},{default:Vue.withCtx(()=>[Vue.createVNode(Vue.unref(naive-ui.NForm),null,{default:Vue.withCtx(()=>[Vue.createVNode(Vue.unref(naive-ui.NFormItem),{label:"标题"},{default:Vue.withCtx(()=>[Vue.createVNode(Vue.unref(naive-ui.NInput),{value:n.title,"onUpdate:value":e[4]||(e[4]=t=>n.title=t),placeholder:"输入标题"},null,8,["value"])]),_:1}),Vue.createVNode(Vue.unref(naive-ui.NFormItem),{label:"分类"},{default:Vue.withCtx(()=>[Vue.createVNode(Vue.unref(naive-ui.NSelect),{value:n.categoryid,"onUpdate:value":e[5]||(e[5]=t=>n.categoryid=t),options:c.value},null,8,["value","options"])]),_:1}),Vue.createVNode(Vue.unref(naive-ui.NFormItem),{label:"内容"},{default:Vue.withCtx(()=>[Vue.createVNode(x,{modelValue:n.content,"onUpdate:modelValue":e[6]||(e[6]=t=>n.content=t),clearCommand:d.value},null,8,["modelValue","clearCommand"])]),_:1}),Vue.createTextVNode(" "+Vue.toDisplayString(n.content),1)]),_:1}),Vue.createElementVNode("div",null,[Vue.createVNode(Vue.unref(naive-ui.NButton),{onClick:C},{default:Vue.withCtx(()=>e[11]||(e[11]=[Vue.createTextVNode("修改")])),_:1})])]),_:1})]),_:1},8,["value"])]))}};export{h as default};
