import{B as n,m as x,d as C,n as m,e as p}from"./naive-ui-DzK7k0L2.js";import"./vooks-C-36Wnvh.js";import"./evtd-CI_DDEu_.js";import"./seemly-BaDA4oAW.js";import"./date-fns-_9zXgOLk.js";import"./vueuc-ohIFSY2e.js";import"./@css-render-B7SAju1e.js";import"./vdirs-Bxp-63WN.js";import"./@juggle-C8OzoCMD.js";import"./css-render-BDrvWz3H.js";import"./@emotion-WldOFDRm.js";import"./treemate-HRdUPn5m.js";import"./async-validator-DKvM95Vc.js";import"./lodash-es-C4meFci_.js";const I={__name:"Category",setup(y){const r=Vue.inject("axios"),o=Vue.inject("message"),c=Vue.inject("dialog"),i=Vue.ref([]),l=Vue.ref(!1),d=Vue.ref(!1);Vue.onMounted(()=>{V()});const V=async()=>{let t=await r.get("/category/list");i.value=t.data.rows},s=Vue.reactive({name:""}),u=Vue.reactive({name:"",id:""}),f=async()=>{try{let t=await r.post("/category/_token/add",{name:s.name});console.log(t),t.data.code==200?(V(),o.success(t.data.msg)):o.error(t.data.msg)}catch(t){o.error(t.response.data.msg)}l.value=!1},g=async t=>{try{c.warning({title:"警告",content:"确认删除？",positiveText:"确定",negativeText:"不确定",onPositiveClick:async()=>{let e=await r.delete(`/category/_token/delete?id=${t.id}`);e.data.code==200?(V(),o.success(e.data.msg)):o.error(e.data.msg)},onNegativeClick:()=>{}})}catch(e){o.error(e.response.data.msg),console.log("其他错误:",e.message)}l.value=!1},N=async t=>{d.value=!0,u.id=t.id,u.name=t.name},v=async()=>{try{let t=await r.put("/category/_token/update",{id:u.id,name:u.name});t.data.code==200?(await Vue.nextTick(),o.success(t.data.msg)):o.error(t.data.msg)}catch(t){o.error(t.response.data.msg),console.log("其他错误:",t.message)}d.value=!1};return(t,e)=>(Vue.openBlock(),Vue.createElementBlock("div",null,[Vue.createVNode(Vue.unref(n),{onClick:e[0]||(e[0]=a=>l.value=!0)},{default:Vue.withCtx(()=>e[7]||(e[7]=[Vue.createTextVNode("添加")])),_:1}),Vue.createVNode(Vue.unref(x),{bordered:!1,"single-line":!1},{default:Vue.withCtx(()=>[e[10]||(e[10]=Vue.createElementVNode("thead",null,[Vue.createElementVNode("tr",null,[Vue.createElementVNode("th",null,"编号"),Vue.createElementVNode("th",null,"名称"),Vue.createElementVNode("th",null,"操作")])],-1)),Vue.createElementVNode("tbody",null,[(Vue.openBlock(!0),Vue.createElementBlock(Vue.Fragment,null,Vue.renderList(i.value,(a,k)=>(Vue.openBlock(),Vue.createElementBlock("tr",null,[Vue.createElementVNode("td",null,Vue.toDisplayString(a.id),1),Vue.createElementVNode("td",null,Vue.toDisplayString(a.name),1),Vue.createElementVNode("td",null,[Vue.createVNode(Vue.unref(C),null,{default:Vue.withCtx(()=>[Vue.createVNode(Vue.unref(n),{onClick:w=>N(a)},{default:Vue.withCtx(()=>e[8]||(e[8]=[Vue.createTextVNode(" 修改 ")])),_:2},1032,["onClick"]),Vue.createVNode(Vue.unref(n),{onClick:w=>g(a)},{default:Vue.withCtx(()=>e[9]||(e[9]=[Vue.createTextVNode("删除")])),_:2},1032,["onClick"])]),_:2},1024)])]))),256))])]),_:1}),Vue.createVNode(Vue.unref(m),{show:l.value,"onUpdate:show":e[3]||(e[3]=a=>l.value=a),preset:"dialog",title:"Dialog"},{header:Vue.withCtx(()=>e[11]||(e[11]=[Vue.createElementVNode("div",null,"添加分类",-1)])),action:Vue.withCtx(()=>[Vue.createElementVNode("div",null,[Vue.createVNode(Vue.unref(n),{onClick:e[2]||(e[2]=a=>f())},{default:Vue.withCtx(()=>e[12]||(e[12]=[Vue.createTextVNode("添加")])),_:1})])]),default:Vue.withCtx(()=>[Vue.createElementVNode("div",null,[Vue.createVNode(Vue.unref(p),{value:s.name,"onUpdate:value":e[1]||(e[1]=a=>s.name=a),type:"text",placeholder:"输入分类"},null,8,["value"])])]),_:1},8,["show"]),Vue.createVNode(Vue.unref(m),{show:d.value,"onUpdate:show":e[6]||(e[6]=a=>d.value=a),preset:"dialog",title:"Dialog"},{header:Vue.withCtx(()=>e[13]||(e[13]=[Vue.createElementVNode("div",null,"修改分类",-1)])),action:Vue.withCtx(()=>[Vue.createElementVNode("div",null,[Vue.createVNode(Vue.unref(n),{onClick:e[5]||(e[5]=a=>v(t.category))},{default:Vue.withCtx(()=>e[14]||(e[14]=[Vue.createTextVNode("修改")])),_:1})])]),default:Vue.withCtx(()=>[Vue.createElementVNode("div",null,[Vue.createVNode(Vue.unref(p),{value:u.name,"onUpdate:value":e[4]||(e[4]=a=>u.name=a),type:"text",placeholder:"输入分类"},null,8,["value"])])]),_:1},8,["show"])]))}};export{I as default};
