/* empty css                    */import{o as U,p as y,f as $,d as k,B as C,i as b,j as p,e as h,q as B}from"./naive-ui-DzK7k0L2.js";import"./vooks-C-36Wnvh.js";import"./evtd-CI_DDEu_.js";import"./seemly-BaDA4oAW.js";import"./date-fns-_9zXgOLk.js";import"./vueuc-ohIFSY2e.js";import"./@css-render-B7SAju1e.js";import"./vdirs-Bxp-63WN.js";import"./@juggle-C8OzoCMD.js";import"./css-render-BDrvWz3H.js";import"./@emotion-WldOFDRm.js";import"./treemate-HRdUPn5m.js";import"./async-validator-DKvM95Vc.js";import"./lodash-es-C4meFci_.js";const T={style:{border:"1px solid #ccc","margin-top":"10px"}},S={__name:"RichTextEditor",props:{modelValue:{type:String,default:""},clearCommand:{type:Boolean,default:!1}},emits:["update:model-value"],setup(_,{emit:d}){const{Toolbar:n,Editor:c}=window.wangeditor,i=Vue.inject("server_url"),V=Vue.shallowRef(),a=Vue.ref(),f=Vue.ref("default"),s={excludeKeys:["uploadVideo"]},m={placeholder:"请输入内容..."};m.MENU_CONF={},m.MENU_CONF.uploadImage={base64LimitSize:10*1024,server:i+"/upload/rich_editor_upload"},m.MENU_CONF.insertImage={parseImageSrc:l=>l.indexOf("Http")!==0?`${i}${l}`:l};const u=_,r=d,N=l=>{console.log("created",l),V.value=l},w=l=>{r("update:model-value",a.value)};return Vue.watch(()=>u.modelValue,l=>{l!==a.value&&(a.value=l)},{immediate:!0}),Vue.watch(()=>u.clearCommand,l=>{l&&(a.value="",console.log("clear"))},{immediate:!0}),(l,v)=>(Vue.openBlock(),Vue.createElementBlock("div",T,[Vue.createVNode(Vue.unref(n),{editor:V.value,defaultConfig:s,mode:f.value,style:{"border-bottom":"1px solid #ccc"}},null,8,["editor","mode"]),Vue.createVNode(Vue.unref(c),{defaultConfig:m,mode:f.value,modelValue:a.value,"onUpdate:modelValue":v[0]||(v[0]=x=>a.value=x),style:{height:"400px","overflow-y":"hidden"},onOnCreated:N,onOnChange:w},null,8,["mode","modelValue"])]))}},D=["onClick"],J={__name:"Article",setup(_){const d=Vue.inject("axios"),n=Vue.inject("message"),c=Vue.ref([]),i=Vue.ref(!1),V=Vue.ref("list"),a=Vue.reactive({page:1,pageSize:3,pageCount:0,count:0});let f=Vue.ref([]);Vue.onMounted(()=>{m(),s()});const s=async()=>{let o=await d.get(`/blog/search?page=${a.page}&pageSize=${a.pageSize}`),e=o.data.rows;for(let t of e){t.content+="...";let g=new Date(t.create_time);t.create_time=`${g.getFullYear()}/${g.getMonth()+1}/${g.getDate()}`}f.value=e,console.log(o),a.count=o.data.count,a.pageCount=Math.ceil(a.count/a.pageSize),console.log(a)},m=async()=>{let o=await d.get("/category/list");c.value=o.data.rows.map(e=>({label:e.name,value:e.id})),console.log(c.value)},u=Vue.reactive({content:"hello",title:"",categoryid:""}),r=Vue.reactive({id:"",title:"",categoryid:"",content:""}),N=async()=>{try{let o=await d.post("/blog/_token/add",{title:u.title,categoryId:u.categoryid,content:u.content});console.log(o),o.data.code==200?(n.success(o.data.msg),u.title="",u.categoryid="",i.value=!0,console.log("command"),setTimeout(()=>i.value=!1,0)):n.error(o.data.msg)}catch(o){n.error(o.response.data.msg)}},w=async o=>{a.page=o,s()},l=async o=>{V.value="update";let e=await d.get("/blog/detail?id="+o.id);console.log(e),r.id=o.id,r.title=e.data.rows[0].title,r.content=e.data.rows[0].content,r.categoryid=e.data.rows[0].category_id},v=async o=>{try{let e=await d.delete("/blog/_token/delete?id="+o.id);e.data.code==200?(n.success(e.data.msg),s()):n.error(e.data.msg)}catch(e){n.error(e.response.data.msg)}},x=async()=>{try{let o=await d.post("/blog/_token/update",r);console.log(o),o.data.code==200?(n.success(o.data.msg),V.value="list",s()):n.error(o.data.msg)}catch(o){n.error(o.response.data.msg)}};return(o,e)=>(Vue.openBlock(),Vue.createElementBlock("div",null,[Vue.createVNode(Vue.unref(U),{value:V.value,"onUpdate:value":e[7]||(e[7]=t=>V.value=t),type:"line",animated:""},{default:Vue.withCtx(()=>[Vue.createVNode(Vue.unref(y),{name:"list",tab:"文章列表"},{default:Vue.withCtx(()=>[(Vue.openBlock(!0),Vue.createElementBlock(Vue.Fragment,null,Vue.renderList(Vue.unref(f),(t,g)=>(Vue.openBlock(),Vue.createElementBlock("div",null,[Vue.createVNode(Vue.unref($),{title:t.title},{footer:Vue.withCtx(()=>[Vue.createVNode(Vue.unref(k),{align:"center"},{default:Vue.withCtx(()=>[Vue.createElementVNode("div",null,Vue.toDisplayString(t.create_time),1),Vue.createVNode(Vue.unref(C),{onClick:E=>l(t)},{default:Vue.withCtx(()=>e[8]||(e[8]=[Vue.createTextVNode("修改")])),_:2},1032,["onClick"]),Vue.createVNode(Vue.unref(C),{onClick:E=>v(t)},{default:Vue.withCtx(()=>e[9]||(e[9]=[Vue.createTextVNode("删除")])),_:2},1032,["onClick"])]),_:2},1024)]),default:Vue.withCtx(()=>[Vue.createTextVNode(Vue.toDisplayString(t.content)+" ",1)]),_:2},1032,["title"])]))),256)),Vue.createVNode(Vue.unref(k),null,{default:Vue.withCtx(()=>[(Vue.openBlock(!0),Vue.createElementBlock(Vue.Fragment,null,Vue.renderList(a.pageCount,t=>(Vue.openBlock(),Vue.createElementBlock("div",{onClick:g=>w(t),style:Vue.normalizeStyle({color:t===a.page?"green":"black"})},Vue.toDisplayString(t),13,D))),256))]),_:1})]),_:1}),Vue.createVNode(Vue.unref(y),{name:"add",tab:"添加文章"},{default:Vue.withCtx(()=>[Vue.createVNode(Vue.unref(b),null,{default:Vue.withCtx(()=>[Vue.createVNode(Vue.unref(p),{label:"标题"},{default:Vue.withCtx(()=>[Vue.createVNode(Vue.unref(h),{value:u.title,"onUpdate:value":e[0]||(e[0]=t=>u.title=t),placeholder:"输入标题"},null,8,["value"])]),_:1}),Vue.createVNode(Vue.unref(p),{label:"分类"},{default:Vue.withCtx(()=>[Vue.createVNode(Vue.unref(B),{value:u.categoryid,"onUpdate:value":e[1]||(e[1]=t=>u.categoryid=t),options:c.value},null,8,["value","options"])]),_:1}),Vue.createVNode(Vue.unref(p),{label:"内容"},{default:Vue.withCtx(()=>[Vue.createVNode(S,{modelValue:u.content,"onUpdate:modelValue":e[2]||(e[2]=t=>u.content=t),clearCommand:i.value},null,8,["modelValue","clearCommand"])]),_:1}),Vue.createTextVNode(" "+Vue.toDisplayString(u.content),1)]),_:1}),Vue.createElementVNode("div",null,[Vue.createVNode(Vue.unref(C),{onClick:e[3]||(e[3]=t=>N())},{default:Vue.withCtx(()=>e[10]||(e[10]=[Vue.createTextVNode("添加")])),_:1})])]),_:1}),Vue.createVNode(Vue.unref(y),{name:"update",tab:"修改文章"},{default:Vue.withCtx(()=>[Vue.createVNode(Vue.unref(b),null,{default:Vue.withCtx(()=>[Vue.createVNode(Vue.unref(p),{label:"标题"},{default:Vue.withCtx(()=>[Vue.createVNode(Vue.unref(h),{value:r.title,"onUpdate:value":e[4]||(e[4]=t=>r.title=t),placeholder:"输入标题"},null,8,["value"])]),_:1}),Vue.createVNode(Vue.unref(p),{label:"分类"},{default:Vue.withCtx(()=>[Vue.createVNode(Vue.unref(B),{value:r.categoryid,"onUpdate:value":e[5]||(e[5]=t=>r.categoryid=t),options:c.value},null,8,["value","options"])]),_:1}),Vue.createVNode(Vue.unref(p),{label:"内容"},{default:Vue.withCtx(()=>[Vue.createVNode(S,{modelValue:r.content,"onUpdate:modelValue":e[6]||(e[6]=t=>r.content=t),clearCommand:i.value},null,8,["modelValue","clearCommand"])]),_:1}),Vue.createTextVNode(" "+Vue.toDisplayString(r.content),1)]),_:1}),Vue.createElementVNode("div",null,[Vue.createVNode(Vue.unref(C),{onClick:x},{default:Vue.withCtx(()=>e[11]||(e[11]=[Vue.createTextVNode("修改")])),_:1})])]),_:1})]),_:1},8,["value"])]))}};export{J as default};
